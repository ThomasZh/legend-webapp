<!DOCTYPE html>
<html class="no-js">
  <head>
    <meta charset="utf-8">
    <title>Shuttle - Material Design Mobile Template</title>
    <meta name="description" content="Material Design Mobile Template">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui">

    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/static/shuttle/img/touch/apple-touch-icon-144x144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/static/shuttle/img/touch/apple-touch-icon-114x114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/static/shuttle/img/touch/apple-touch-icon-72x72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="/static/shuttle/img/touch/apple-touch-icon-57x57-precomposed.png">
    <link rel="shortcut icon" sizes="196x196" href="/static/shuttle/img/touch/touch-icon-196x196.png">
    <link rel="shortcut icon" href="/static/shuttle/img/touch/apple-touch-icon.png">

    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="/static/shuttle/img/touch/apple-touch-icon-144x144-precomposed.png">
    <meta name="msapplication-TileColor" content="#222222">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- SEO: If mobile URL is different from desktop URL, add a canonical link to the desktop page -->
    <!--
    <link rel="canonical" href="http://www.example.com/" >
    -->

    <!-- For iOS web apps. Delete if not needed. https://github.com/h5bp/mobile-boilerplate/issues/94 -->
    <!--
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="">
    -->

    <!-- Fonts -->
    <!-- <link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,700,100' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Varela+Round' rel='stylesheet' type='text/css'>
    <!-- Icons -->
    <link href="http://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css" media="all" rel="stylesheet" type="text/css"> -->

    <!-- Stylesheets -->
    <link rel="stylesheet" href="{{ static_url('shuttle/css/animate.css') }}">
    <link rel="stylesheet" href="{{ static_url('shuttle/css/materialize.min.css') }}">
    <link rel="stylesheet" href="{{ static_url('shuttle/css/swipebox.min.css') }}">
    <link rel="stylesheet" href="{{ static_url('shuttle/css/swiper.min.css') }}">
    <link rel="stylesheet" href="{{ static_url('shuttle/css/normalize.css') }}">
    <link rel="stylesheet" href="{{ static_url('shuttle/css/main.css') }}">
  </head>

  <body>

    <!-- Main Container -->
    <div id="main" class="main">

      <!-- Toolbar -->
      <div id="toolbar" class="primary-color tool-login">
        <div class="open-left" id="open-left" data-activates="slide-out-left">
          <i class="ion-android-menu white-text"></i>
        </div>
      </div>
      <!-- End of Toolbar -->

      <!-- Page Contents -->
      <div class="page fullscreen grey lighten-4">

        <form id="login-form" method="POST" action="/webapp/auth/login">
        <div class="login-form z-depth-1">
          <h1>登录</h1>
          <div class="input-field">
            <i class="ion-android-contact prefix"></i>
            <input class="validate" id="lg_phone" name="lg_phone" type="text">
            <label for="lg_phone">电话</label>
          </div>

          <div class="input-field" style="margin-bottom:20px;">
            <i class="ion-android-lock prefix"></i>
            <input class="validate" id="lg_pwd" name="lg_pwd" type="password">
            <label for="lg_pwd">密码</label>
          </div>

          <span id="err_msg" style="color:red;">{{ err_msg }}</span>
          <a class="waves-effect waves-light btn-large primary-color block m-b-20 animated bouncein delay-2"
           href="#" name="submit" onclick="login()">登录</a>
          <div>没有账号? <a class="primary-text" href="regist">注册</a></div>
          <div>忘记密码? <a class="primary-text" href="forget">找回</a></div>
        </div>
        </form>

      </div>
      <!-- End of Page Contents -->

      <!-- Sidebars -->
      <!-- left sidebar -->
      {% module Template("shuttle/block-left-sidebar.html") %}
      <!-- /left sidebar -->

      <!-- right sidebar -->
      {% module Template("shuttle/block-right-sidebar.html") %}
      <!-- /right sidebar -->
      <!-- End of Sidebars -->

    </div>
    <!-- End of Main Container -->

    <!-- Scripts -->
    <script src="{{ static_url('shuttle/js/vendor/jquery-2.1.0.min.js') }}"></script>
    <script src="{{ static_url('shuttle/js/helper.js') }}"></script>
    <script src="{{ static_url('shuttle/js/vendor/HeadsUp.js') }}"></script>
    <script src="{{ static_url('shuttle/js/vendor/jquery.smoothState.js') }}"></script>
    <script src="{{ static_url('shuttle/js/vendor/chart.min.js') }}"></script>
    <script src="{{ static_url('shuttle/js/vendor/jquery.mixitup.min.js') }}"></script>
    <script src="{{ static_url('shuttle/js/vendor/jquery.swipebox.min.js') }}"></script>
    <script src="{{ static_url('shuttle/js/vendor/masonry.min.js') }}"></script>
    <script src="{{ static_url('shuttle/js/vendor/swiper.min.js') }}"></script>
    <script src="{{ static_url('shuttle/js/vendor/materialize.min.js') }}"></script>
    <script src="{{ static_url('shuttle/js/main.js') }}"></script>

    <script type="text/javascript" src="{{ static_url('js/jquery.validate.min.js') }}"></script>
    <script type="text/javascript" src="{{ static_url('js/localization/messages_zh.min.js') }}"></script>
    <script type="text/javascript" src="{{ static_url('upyun/js/spark-md5.min.js') }}"></script>
    <script type="text/javascript" src="{{ static_url('js/json2.js') }}"></script>

    <script>
      $(function() {
        // 字符验证
        jQuery.validator.addMethod("stringCheck", function(value, element) {
          return this.optional(element) || /^[\u0391-\uFFE5\w]+$/.test(value);
        }, "只能包括中文字、英文字母、数字和下划线");

        // 中文字两个字节
        jQuery.validator.addMethod("byteRangeLength", function(value, element, param) {
          var length = value.length;
          for (var i = 0; i < value.length; i++) {
            if (value.charCodeAt(i) > 127) {
              length++;
            }
          }
          return this.optional(element) || (length >= param[0] && length <= param[1]);
        }, "请确保输入的值在3-15个字节之间(一个中文字算2个字节)");

        // 手机号码验证
        jQuery.validator.addMethod("mobile", function(value, element) {
          var length = value.length;
          var mobile = /^(((13[0-9]{1})|(15[0-9]{1})|(17[0-9]{1})|(18[0-9]{1})|(19[0-9]{1}))+\d{8})$/;
          return this.optional(element) || (length == 11 && mobile.test(value));
        }, "请正确填写您的手机号码");

        // 电话号码验证
        jQuery.validator.addMethod("tel", function(value, element) {
          var tel = /^\d{3,4}-?\d{7,9}$/; //电话号码格式010-12345678
          return this.optional(element) || (tel.test(value));
        }, "请正确填写您的电话号码");

        // 邮政编码验证
        jQuery.validator.addMethod("zipCode", function(value, element) {
          var tel = /^[0-9]{6}$/;
          return this.optional(element) || (tel.test(value));
        }, "请正确填写您的邮政编码");

        // 身份证号码验证
        jQuery.validator.addMethod("idCardNo", function(value, element) {
          return this.optional(element) || idCardNoUtil.checkIdCardNo(value);
        }, "请正确输入您的身份证号码");

        //护照编号验证
        jQuery.validator.addMethod("passport", function(value, element) {
          return this.optional(element) || checknumber(value);
        }, "请正确输入您的护照编号");

        // Login Form
        //----------------------------------------------
        // Validation
        $("#login-form").validate({
          rules: {
            lg_phone: {
              minlength: 11,
              maxlength: 11,
              required: true,
              mobile: true
            },
            lg_pwd: {
              required: true,
              minlength: 6
            },
          },
          errorClass: "form-invalid",
          submitHandler: function(form) {
            // var pwd = $("#lg_pwd").val();
            // var md5pwd = SparkMD5.hash(pwd);
            // $("#lg_pwd").val(md5pwd);
            form.submit();
          }
        });
      });

      function login(){
        var pwd = $("#lg_pwd").val();
        var md5pwd = SparkMD5.hash(pwd);
        $("#lg_pwd").val(md5pwd);
        $("#login-form").submit();
      }
    </script>

  </body>
</html>
